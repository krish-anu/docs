---
title: "App Structure"
description: "Understanding the Next.js App Router structure"
---

## App Router Organization

The client uses Next.js 14's App Router with route groups for different user roles.

```
app/
├── globals.css           # Global styles with CSS variables
├── layout.tsx            # Root layout with providers
├── page.tsx              # Landing page (/)
├── providers.tsx         # React Query & Auth providers
├── not-found.tsx         # 404 page
│
├── login/                # /login
│   └── page.tsx
├── signup/               # /signup
│   └── page.tsx
├── verify/               # /verify (OTP)
│   └── page.tsx
│
├── users/                # /users/* (authenticated users)
│   ├── layout.tsx        # User layout with sidebar
│   ├── dashboard/
│   ├── bookings/
│   ├── notifications/
│   ├── pending-pickups/
│   └── profile/
│
├── admin/                # /admin/* (admin only)
│   ├── layout.tsx        # Admin layout
│   ├── dashboard/
│   ├── bookings/
│   ├── drivers/
│   ├── pricing/
│   └── users/
│
└── driver/               # /driver/* (drivers only)
    ├── layout.tsx        # Driver layout
    ├── dashboard/
    └── bookings/
```

## Route Groups

### Authentication Routes

Public routes accessible without login:

| Route     | Description       |
| --------- | ----------------- |
| `/login`  | User login page   |
| `/signup` | User registration |
| `/verify` | OTP verification  |

### User Routes (`/users/*`)

Protected routes for authenticated users:

| Route                    | Description                 |
| ------------------------ | --------------------------- |
| `/users/dashboard`       | User dashboard with KPIs    |
| `/users/bookings`        | Booking list and management |
| `/users/bookings/new`    | Create new booking          |
| `/users/bookings/[id]`   | Booking details             |
| `/users/notifications`   | Notification center         |
| `/users/pending-pickups` | Upcoming pickups            |
| `/users/profile`         | User profile settings       |

### Admin Routes (`/admin/*`)

Protected routes for admin users:

| Route              | Description                |
| ------------------ | -------------------------- |
| `/admin/dashboard` | Admin dashboard with stats |
| `/admin/bookings`  | All bookings management    |
| `/admin/drivers`   | Driver management          |
| `/admin/users`     | User management            |
| `/admin/pricing`   | Pricing configuration      |

### Driver Routes (`/driver/*`)

Protected routes for driver users:

| Route               | Description       |
| ------------------- | ----------------- |
| `/driver/dashboard` | Driver dashboard  |
| `/driver/bookings`  | Assigned bookings |

## Layouts

### Root Layout (`app/layout.tsx`)

```tsx
export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>
        <Providers>
          {children}
          <Toaster />
        </Providers>
      </body>
    </html>
  );
}
```

### User Layout (`app/users/layout.tsx`)

```tsx
export default function UserLayout({ children }) {
  return (
    <RequireAuth allowedRoles={["USER"]}>
      <AppShell>
        <Sidebar role="user" />
        <main>{children}</main>
      </AppShell>
    </RequireAuth>
  );
}
```

## Page Component Pattern

Each page follows a consistent pattern:

```tsx
// app/users/dashboard/page.tsx
"use client";

import { useQuery } from "@tanstack/react-query";
import { apiFetch } from "@/lib/api";

export default function DashboardPage() {
  const { data, isLoading } = useQuery({
    queryKey: ["dashboard"],
    queryFn: () => apiFetch("/users/dashboard"),
  });

  if (isLoading) return <Loading />;

  return (
    <div className="space-y-6">
      <h1>Dashboard</h1>
      {/* Page content */}
    </div>
  );
}
```

## Dynamic Routes

### Booking Details (`/users/bookings/[id]`)

```tsx
// app/users/bookings/[id]/page.tsx
export default function BookingDetailPage({
  params,
}: {
  params: { id: string };
}) {
  const { id } = params;
  // Fetch booking by id
}
```

## Loading & Error States

### Loading UI

```tsx
// app/users/bookings/loading.tsx
export default function Loading() {
  return <Skeleton className="h-96 w-full" />;
}
```

### Error UI

```tsx
// app/users/bookings/error.tsx
"use client";

export default function Error({ error, reset }) {
  return (
    <div>
      <h2>Something went wrong!</h2>
      <button onClick={() => reset()}>Try again</button>
    </div>
  );
}
```

## Metadata

```tsx
// app/users/dashboard/page.tsx
import { Metadata } from "next";

export const metadata: Metadata = {
  title: "Dashboard | Trash2Cash",
  description: "View your waste collection stats and earnings",
};
```
