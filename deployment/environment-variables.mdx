---
title: "Environment Variables"
description: "Required environment configuration for Trash2Cash"
---

## Overview

Trash2Cash requires environment variables for both server and client. Create `.env` files in the root directory for Docker Compose to use.

## Required Environment Variables

Create `.env` at the project root:

```bash
# Database (Required)
DATABASE_URL="postgresql://user:password@host:5432/trash2cash?schema=public"
DIRECT_URL="postgresql://user:password@host:5432/trash2cash"

# JWT (Required)
JWT_ACCESS_SECRET="your-access-secret-min-32-chars"
JWT_REFRESH_SECRET="your-refresh-secret-min-32-chars"
JWT_ACCESS_EXPIRES="15m"
JWT_REFRESH_EXPIRES="7d"

# Server Configuration
PORT=4000
NODE_ENV=development
CORS_ORIGIN=http://localhost:3000

# Frontend API URL
NEXT_PUBLIC_API_URL=http://localhost:4000/api

# Third-party APIs (Optional)
GEMINI_API_KEY="your-gemini-api-key"
TEXTLK_API_TOKEN="your-textlk-api-token"
TEXTLK_SENDER_ID="TextLKDemo"
```

## Docker Compose Setup

### Development Environment

```bash
# Start services with local PostgreSQL
docker-compose -f docker-compose.dev.yml --profile local-db up --build

# Or use external PostgreSQL
docker-compose -f docker-compose.dev.yml up --build
```

### Production Environment

For production, ensure your `.env` contains:

```bash
DATABASE_URL="postgresql://user:password@prod-host:5432/trash2cash?schema=public"
DIRECT_URL="postgresql://user:password@prod-host:5432/trash2cash"
NODE_ENV=production
CORS_ORIGIN=https://your-production-domain.com
NEXT_PUBLIC_API_URL=https://api.your-production-domain.com/api
```

Then start:

```bash
docker-compose -f docker-compose.prod.yml up
```

## Environment Variable Reference

### Database

| Variable       | Description                                   | Required | Example                                                          |
| -------------- | --------------------------------------------- | -------- | ---------------------------------------------------------------- |
| `DATABASE_URL` | PostgreSQL connection with schema             | ✅       | `postgresql://user:pass@localhost:5432/trash2cash?schema=public` |
| `DIRECT_URL`   | PostgreSQL direct connection (for migrations) | ✅       | `postgresql://user:pass@localhost:5432/trash2cash`               |

### JWT Authentication

| Variable              | Description                              | Required | Default |
| --------------------- | ---------------------------------------- | -------- | ------- |
| `JWT_ACCESS_SECRET`   | Secret for access tokens (min 32 chars)  | ✅       | N/A     |
| `JWT_REFRESH_SECRET`  | Secret for refresh tokens (min 32 chars) | ✅       | N/A     |
| `JWT_ACCESS_EXPIRES`  | Access token expiry                      | ❌       | `15m`   |
| `JWT_REFRESH_EXPIRES` | Refresh token expiry                     | ❌       | `7d`    |

### Server Configuration

| Variable      | Description           | Required | Default                 |
| ------------- | --------------------- | -------- | ----------------------- |
| `PORT`        | Server port           | ❌       | `4000`                  |
| `NODE_ENV`    | Run mode              | ❌       | `development`           |
| `CORS_ORIGIN` | Frontend URL for CORS | ✅       | `http://localhost:3000` |

### Frontend Configuration

| Variable                       | Description                       | Required | Default                     |
| ------------------------------ | --------------------------------- | -------- | --------------------------- |
| `NEXT_PUBLIC_API_URL`          | Backend API URL                   | ✅       | `http://localhost:4000/api` |
| `NEXT_PUBLIC_GOOGLE_CLIENT_ID` | Google OAuth Client ID (frontend) | ❌       | N/A                         |

### External APIs

| Variable           | Description               | Required |
| ------------------ | ------------------------- | -------- |
| `GEMINI_API_KEY`   | Google Gemini API key     | ❌       |
| `TEXTLK_API_TOKEN` | Text.lk SMS gateway token | ❌       |
| `TEXTLK_SENDER_ID` | Text.lk sender ID         | ❌       |

### Google OAuth (Server)

| Variable               | Description                       | Required |
| ---------------------- | --------------------------------- | -------- |
| `GOOGLE_CLIENT_ID`     | Google OAuth Client ID for server | ❌       |
| `GOOGLE_CLIENT_SECRET` | Google OAuth Client Secret        | ❌       |
| `GOOGLE_REDIRECT_URI`  | OAuth callback URL                | ❌       |

## Generating Secrets

### JWT Secrets

Generate random 64-character secrets:

```bash
# On Linux/Mac
openssl rand -base64 48

# On Windows PowerShell
[Convert]::ToBase64String([Security.Cryptography.RNGCryptoServiceProvider]::new().GetBytes(48))
```

Example output:

```
xyz123abc...def456ghi
```

## Environment by Stage

### Local Development (with local PostgreSQL)

````

### Production

```bash
# server/.env.production
DATABASE_URL="postgresql://user:pass@prod-db:5432/trash2cash"
JWT_SECRET="production-super-secure-secret-key"
NODE_ENV=production
CLIENT_URL="https://trash2cash.lk"

# client/.env.production
NEXT_PUBLIC_API_URL="https://api.trash2cash.lk/api"
````

## Docker Compose Environment

When using Docker Compose, create a `.env` file in the root:

```bash
# .env (root directory)
POSTGRES_USER=trash2cash
POSTGRES_PASSWORD=secure_password_here
POSTGRES_DB=trash2cash

JWT_SECRET=your-super-secret-jwt-key-min-32-chars

CLIENT_URL=http://localhost:3000
NEXT_PUBLIC_API_URL=http://localhost:3001/api
```

## Security Best Practices

<Warning>
  Never commit `.env` files to version control. Add them to `.gitignore`.
</Warning>

### .gitignore

```
# Environment files
.env
.env.local
.env.staging
.env.production
*.env
```

### Recommendations

1. **Use different secrets per environment** - Never share JWT secrets between dev/staging/prod
2. **Rotate secrets regularly** - Change JWT_SECRET periodically
3. **Use strong passwords** - Use password generators for database credentials
4. **Limit access** - Only give environment variables to services that need them
5. **Use secrets management** - In production, use AWS Secrets Manager, Vault, etc.

## Related Pages

<CardGroup cols={2}>
  <Card title="Docker" icon="docker" href="/deployment/docker">
    Docker Compose setup.
  </Card>
  <Card title="Production" icon="rocket" href="/deployment/production">
    Production deployment.
  </Card>
</CardGroup>
